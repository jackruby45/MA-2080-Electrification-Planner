<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Natural Gas to Electrification Tool</title>
    <link rel="stylesheet" href="index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <header>
        <h1>Natural Gas to Electrification Tool</h1>
        <p>Estimate the electrical and financial impact of switching from natural gas to electric appliances in Massachusetts.</p>
    </header>
    <main>
        <div class="tabs">
            <button id="tab-planner" class="tab-button active" role="tab" aria-selected="true" aria-controls="planner-content">Planner</button>
            <button id="tab-report" class="tab-button" role="tab" aria-selected="false" aria-controls="report-content-wrapper">Report</button>
            <button id="tab-methodology" class="tab-button" role="tab" aria-selected="false" aria-controls="methodology-content">Methodology</button>
            <button id="tab-input-tables" class="tab-button" role="tab" aria-selected="false" aria-controls="input-tables-content">Input Tables</button>
            <button id="tab-save-load" class="tab-button" role="tab" aria-selected="false" aria-controls="save-load-content">Save/Load Project</button>
        </div>

        <div id="planner-content" class="tab-content active" role="tabpanel" aria-labelledby="tab-planner">
            <section id="inputs" aria-labelledby="inputs-heading">
                <h2 id="inputs-heading" class="sr-only">Inputs</h2>
                <div class="card">
                    <h3 class="card-title">Facility Information</h3>
                    <div class="form-grid">
                        <div class="form-field">
                            <label for="facility-type">Facility Type
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Select the type of building. This sets a baseline for typical annual gas usage, which you can then adjust.</span>
                                </div>
                            </label>
                            <select id="facility-type" name="facility-type">
                                <option value="Residential">Residential</option>
                                <option value="Small Commercial">Small Commercial</option>
                                <option value="Large Commercial">Large Commercial</option>
                                <option value="Industrial">Industrial</option>
                                <option value="Restaurant">Restaurant</option>
                                <option value="Medical">Medical Facility</option>
                                <option value="Nursing Home">Nursing Home</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label for="address-number">Address Number</label>
                            <input type="text" id="address-number" name="address-number" value="45">
                        </div>
                        <div class="form-field">
                            <label for="street-name">Street Name</label>
                            <input type="text" id="street-name" name="street-name" value="Main Street">
                        </div>
                        <div class="form-field">
                            <label for="town">Town</label>
                            <input type="text" id="town" name="town" value="Gardner">
                        </div>
                    </div>
                </div>
                 <div class="card">
                    <h3 class="card-title">Annual Gas Usage</h3>
                    <div class="form-grid">
                        <div class="form-field">
                            <label for="annual-heating-therms">Heating Usage (therms)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Enter your total annual gas usage for heating, in therms. You can find this on your gas utility bills, often as a yearly summary.</span>
                                </div>
                            </label>
                            <input type="number" id="annual-heating-therms" name="annual-heating-therms" value="700" min="0" step="10">
                        </div>
                         <div class="form-field">
                            <label for="annual-non-heating-therms">Non-Heating Usage (therms)
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Enter your total annual gas usage for non-heating appliances like water heaters, ranges, and dryers. This is your 'base' usage, often found on utility bills.</span>
                                </div>
                            </label>
                            <input type="number" id="annual-non-heating-therms" name="annual-non-heating-therms" value="250" min="0" step="10">
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">Current Electrical Service</h3>
                    <div class="form-grid">
                        <div class="form-field">
                            <label for="panel-amperage">Main Panel Amperage
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">The capacity of your main electrical panel in Amperes (A). This is usually printed on the main breaker switch at the top of the panel.</span>
                                </div>
                            </label>
                            <select id="panel-amperage" name="panel-amperage">
                                <option value="100">100 A</option>
                                <option value="125">125 A</option>
                                <option value="150">150 A</option>
                                <option value="200" selected>200 A</option>
                                <option value="400">400 A</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label for="voltage">Voltage
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">The standard voltage for your electrical service. Most residential and small commercial buildings in the US use 240V.</span>
                                </div>
                            </label>
                            <input type="number" id="voltage" name="voltage" value="240" step="1">
                        </div>
                         <div class="form-field">
                            <label for="breaker-spaces">Available Breaker Spaces
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">The number of empty slots in your electrical panel where new circuit breakers can be installed. Each new 240V appliance typically requires two spaces.</span>
                                </div>
                            </label>
                            <input type="number" id="breaker-spaces" name="breaker-spaces" value="4" min="0">
                        </div>
                         <div class="form-field">
                            <label for="annual-existing-elec-kwh">Annual Electric Usage (kWh)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Enter your total electricity usage for the last 12 months. This is found on your utility bill summary and provides a baseline for calculating total bill impact.</span>
                                </div>
                            </label>
                            <input type="number" id="annual-existing-elec-kwh" name="annual-existing-elec-kwh" value="8000" min="0" step="100">
                        </div>
                        <div class="form-field">
                            <label for="existing-peak-load-amps">Est. Existing Peak Load (Amps)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">The estimated peak power draw from existing appliances (A/C, lights, etc.). A reasonable estimate is calculated for you, but you can override it if you have a more accurate number from an electrician or your utility.</span>
                                </div>
                            </label>
                            <input type="number" id="existing-peak-load-amps" name="existing-peak-load-amps" value="30" min="0" step="1">
                        </div>
                        <div id="residential-ev-charger-field" class="form-field">
                            <label for="ev-charger">Include EV Charger
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Include a Level 2 EV charger in the electrical load calculation to assess its impact on your panel.</span>
                                </div>
                            </label>
                            <select id="ev-charger" name="ev-charger">
                                <option value="none">None</option>
                                <option value="32A">Level 2 (32A / 7.7kW)</option>
                                <option value="40A">Level 2 (40A / 9.6kW)</option>
                                <option value="48A">Level 2 (48A / 11.5kW)</option>
                            </select>
                        </div>
                        <div id="commercial-ev-stations-field" class="form-field hidden">
                            <label for="commercial-ev-stations">Number of EV Stations
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Enter the number of Level 2 (40A) EV charging stations to include in the load calculation. A typical count is pre-filled based on facility type.</span>
                                </div>
                            </label>
                            <input type="number" id="commercial-ev-stations" name="commercial-ev-stations" value="0" min="0">
                        </div>
                         <div class="form-field">
                            <label for="efficiency-tier">Efficiency Target
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Select the desired efficiency level for new electric appliances. Higher efficiency costs more upfront but results in lower annual energy costs and greater savings.</span>
                                </div>
                            </label>
                            <select id="efficiency-tier" name="efficiency-tier">
                                <option value="Standard">Standard</option>
                                <option value="High" selected>High</option>
                                <option value="Premium">Premium</option>
                            </select>
                        </div>
                    </div>
                </div>
                 <div class="card">
                    <h3 class="card-title">Utility Costs & Projections</h3>
                     <div class="form-grid">
                         <div class="form-field full-width-field">
                            <div class="checkbox-field">
                                <input type="checkbox" id="use-tou-rates" name="use-tou-rates">
                                <label for="use-tou-rates">Use Advanced Time-of-Use (TOU) Electric Rates</label>
                            </div>
                        </div>
                     </div>
                     <div id="tou-rates-grid" class="form-grid cost-grid hidden">
                        <div class="form-field">
                            <label for="peak-price">Peak Rate ($/kWh)</label>
                            <div class="input-with-unit unit-left">
                                 <span>$</span>
                                <input type="number" id="peak-price" name="peak-price" value="0.35" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="off-peak-price">Off-Peak Rate ($/kWh)</label>
                            <div class="input-with-unit unit-left">
                                 <span>$</span>
                                <input type="number" id="off-peak-price" name="off-peak-price" value="0.18" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="off-peak-percent">Off-Peak Usage %
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Estimate the percentage of your new heating/cooling load that will occur during off-peak hours.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-right">
                                <input type="number" id="off-peak-percent" name="off-peak-percent" value="50" step="1" min="0" max="100">
                                <span>%</span>
                            </div>
                        </div>
                    </div>
                     <div class="form-grid cost-grid">
                        <div class="form-field">
                            <label for="gas-price">Gas Price ($/therm)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Your current cost for natural gas per therm. Check your utility bill for the 'supply' and 'delivery' charges combined.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-left">
                                <span>$</span>
                                <input type="number" id="gas-price" name="gas-price" value="1.50" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="electricity-price">Elec Price ($/kWh)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Your current cost for electricity per kilowatt-hour (kWh). Check your utility bill for the 'supply' and 'delivery' charges combined. This is ignored if TOU rates are used.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-left">
                                 <span>$</span>
                                <input type="number" id="electricity-price" name="electricity-price" value="0.28" step="0.01" min="0">
                            </div>
                        </div>
                         <div class="form-field">
                            <label for="gas-price-escalation">Gas Δ (%/yr)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">The projected standard annual increase in natural gas prices. A default of 2% is used for typical inflation.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-right">
                                <input type="number" id="gas-price-escalation" name="gas-price-escalation" value="2" step="0.1" min="0">
                                <span>%</span>
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="electricity-price-escalation">Elec Δ (%/yr)
                                 <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">The projected standard annual increase in electricity prices. A default of 2% is used for typical inflation.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-right">
                                <input type="number" id="electricity-price-escalation" name="electricity-price-escalation" value="2" step="0.1" min="0">
                                <span>%</span>
                            </div>
                        </div>
                         <div class="form-field">
                            <label for="high-risk-gas-escalation">High-Risk Gas Δ
                               <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Potential annual gas rate increase for remaining customers as the state transitions to electrification, based on DPU dockets on stranded asset risk.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-right">
                                <input type="number" id="high-risk-gas-escalation" name="high-risk-gas-escalation" value="7" step="0.1" min="0">
                                <span>%</span>
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="grid-decarbonization-rate">Grid De-CO₂ Rate
                               <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Projected annual reduction in grid emissions factor (%/yr) as more renewables come online. This shows how your project's emissions will decrease over time.</span>
                                </div>
                            </label>
                            <div class="input-with-unit unit-right">
                                <input type="number" id="grid-decarbonization-rate" name="grid-decarbonization-rate" value="2" step="0.1" min="0">
                                <span>%</span>
                            </div>
                        </div>
                        <div class="form-field full-width-field">
                             <label for="environmental-unit">Environmental Impact Units
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Choose how to display the greenhouse gas reduction results in the report summary.</span>
                                </div>
                            </label>
                            <select id="environmental-unit" name="environmental-unit">
                                <option value="kg">Kilograms (kg CO₂e)</option>
                                <option value="tons">Metric Tons (t CO₂e)</option>
                                <option value="cars">Cars off road (equivalent)</option>
                                <option value="miles">Miles driven (equivalent)</option>
                                <option value="gasoline">Gallons of gasoline (equivalent)</option>
                                <option value="oil">Barrels of oil (equivalent)</option>
                                <option value="trees">Tree seedlings grown for 10 yrs</option>
                            </select>
                        </div>
                     </div>
                </div>
                <div class="card">
                    <h3 class="card-title">Natural Gas Appliances to Electrify</h3>
                    <div id="appliances-list">
                        <p class="empty-state">No appliances added yet.</p>
                    </div>
                    <button id="add-appliance-btn" class="button-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>
                        <span>Add Appliance</span>
                    </button>
                </div>
            </section>
            <section id="report-summary-column" aria-labelledby="report-heading">
                 <div class="card report-card">
                    <h2 id="report-heading" class="card-title">Your Electrification Report</h2>
                    
                    <div id="report-summary" class="report-summary">
                        <div class="summary-metric">
                            <span class="summary-metric-label">Net Project Cost (Likely)</span>
                            <span id="summary-total-cost" class="summary-metric-value">$0 (Range: $0 - $0)</span>
                        </div>
                         <div class="summary-metric">
                            <span class="summary-metric-label">Estimated Rebates</span>
                            <span id="summary-total-rebates" class="summary-metric-value status-sufficient">$0</span>
                        </div>
                        <div class="summary-metric">
                            <span class="summary-metric-label">Simple Payback Period</span>
                            <span id="summary-payback-period" class="summary-metric-value">N/A</span>
                        </div>
                         <div class="summary-metric">
                            <span class="summary-metric-label">Net Annual Savings</span>
                            <span id="summary-annual-savings" class="summary-metric-value status-sufficient">$0</span>
                        </div>
                         <div class="summary-metric">
                            <span class="summary-metric-label">Est. 15-Year Savings</span>
                            <span id="summary-lifetime-savings" class="summary-metric-value status-sufficient">$0</span>
                        </div>
                         <div class="summary-metric">
                            <span class="summary-metric-label">15-Yr Savings (High-Risk)</span>
                            <span id="summary-lifetime-savings-high-risk" class="summary-metric-value status-sufficient">$0</span>
                        </div>
                        <div class="summary-metric">
                            <span class="summary-metric-label">Annual GHG Reduction (20-yr)
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Total greenhouse gas reduction in CO₂ equivalent, including methane's potent short-term impact (GWP over 20 years).</span>
                                </div>
                            </span>
                            <span id="summary-ghg-reduction-20yr" class="summary-metric-value status-sufficient">0 kg CO₂e</span>
                        </div>
                         <div class="summary-metric">
                            <span class="summary-metric-label">Annual GHG Reduction (100-yr)
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Total greenhouse gas reduction in CO₂ equivalent, based on the standard 100-year impact (GWP over 100 years).</span>
                                </div>
                            </span>
                            <span id="summary-ghg-reduction-100yr" class="summary-metric-value status-sufficient">0 kg CO₂e</span>
                        </div>
                        <div class="summary-metric">
                            <span class="summary-metric-label">GHG Reduction Equivalent
                                <div class="tooltip-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="tooltip-text">Translates the 100-year GHG reduction into the equivalent number of typical gasoline-powered cars taken off the road for one year (based on EPA estimates).</span>
                                </div>
                            </span>
                            <span id="summary-ghg-equivalent" class="summary-metric-value status-sufficient">0 cars</span>
                        </div>
                    </div>
    
                    <div id="report-details">
                        <!-- Detailed breakdowns will be inserted here by the script -->
                    </div>
                </div>
            </section>
        </div>

        <div id="report-content-wrapper" class="tab-content" role="tabpanel" aria-labelledby="tab-report">
             <div class="card full-report-card">
                <div class="report-actions">
                    <button id="export-pdf-btn" class="button-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20"><path d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z" /><path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" /></svg>
                        <span>Export to PDF</span>
                    </button>
                </div>
                <div id="full-report-content">
                    <!-- The full, detailed report will be inserted here -->
                </div>
            </div>
        </div>
        
        <div id="methodology-content" class="tab-content" role="tabpanel" aria-labelledby="tab-methodology">
            <h3>Introduction: The 'Why' Behind This Tool</h3>
            <p>This tool is designed to provide a comprehensive, data-driven estimate of the impacts of strategic electrification—the process of replacing appliances that run on fossil fuels (like natural gas) with high-efficiency electric alternatives. In Massachusetts, this transition is a cornerstone of the state's plan to achieve its ambitious climate goals, as outlined in regulatory proceedings like the Department of Public Utilities (DPU) Docket 20-80, "The Future of Gas."</p>
            <p>Our goal is to demystify this process by modeling the key factors you need to consider: the impact on your electrical system, the upfront and long-term costs, operational savings, and the full environmental footprint. This methodology explains exactly how we get from your inputs to the final report.</p>

            <h3>Core Concepts: Understanding the Numbers</h3>
            <h4>Energy vs. Power</h4>
            <ul>
                <li><strong>Power (kW):</strong> Kilowatts measure the <em>rate</em> at which energy is used at any given moment. It's like the speed of your car. This is critical for the <strong>Electrical Load Analysis</strong> to ensure your electrical panel can supply enough power at peak times without being overloaded.</li>
                <li><strong>Energy (kWh):</strong> Kilowatt-hours measure the <em>total amount</em> of a-zA-Z0-9_ -Z' energy consumed over time. It's like the total distance you've driven. This is used in the <strong>Operating Cost Analysis</strong> to calculate your annual utility bills.</li>
            </ul>

            <h4>Heating, Cooling & Efficiency Metrics</h4>
            <ul>
                <li><strong>BTU (British Thermal Unit):</strong> The standard unit of heat. A gas furnace might be rated in BTU/hour, indicating its maximum heat output rate.</li>
                <li><strong>COP (Coefficient of Performance):</strong> A simple ratio of how much useful heat an electric heat pump moves compared to the electricity it consumes. A COP of 3.0 means it moves 3 units of heat for every 1 unit of electricity, making it 300% efficient. This tool uses COP because it allows for a direct, apples-to-apples conversion from the "useful heat" of your gas appliance to the electricity needed for its replacement.</li>
                <li><strong>Cold Climate Performance:</strong> Modern cold-climate heat pumps work efficiently even in Massachusetts winters. However, performance does decrease as outside temperatures drop. To provide a conservative and realistic estimate, this tool applies a <strong>15% penalty</strong> to the rated COP for all heating calculations.</li>
            </ul>
            
            <h4>Natural Gas Metrics</h4>
            <ul>
                <li><strong>Therm:</strong> The standard unit for billing natural gas, equivalent to 100,000 BTUs of energy content.</li>
                <li><strong>Useful Heat vs. Input Energy:</strong> This is a critical concept. An 80,000 BTU furnace with 80% efficiency doesn't deliver 80,000 BTUs of heat to your home; it delivers only 64,000 BTUs. The other 20% is wasted as exhaust. The tool's first step is always to calculate this "useful heat" to determine how much work the new electric appliance actually needs to do.</li>
            </ul>
            <div class="formula-box">Useful Heat (BTU) = Gas Usage (therms) × 100,000 BTU/therm × Gas Efficiency (%)</div>

            <h3>How the Analysis Works: A Step-by-Step Guide</h3>
            <h4>Step 1: Baseline Energy Calculation</h4>
            <p>The foundation of the entire analysis is understanding how much energy your current gas system uses. We take your annual gas usage in therms (for heating and non-heating) and multiply it by the efficiency of each gas appliance you list. This calculation gives us the total "useful BTUs" your home requires annually, which is the target our new electric system must meet.</p>

            <h4>Step 2: Electric Equivalent Energy</h4>
            <p>Once we know the useful BTUs required, we can calculate how many kilowatt-hours (kWh) of electricity are needed for the electric replacements. This is done by converting the useful BTUs to kWh and then dividing by the COP of the new appliance.</p>
            <div class="formula-box">Electric Energy (kWh) = [Useful Heat (BTU) × 0.000293 kWh/BTU] / (COP × Cold Climate Penalty)</div>
            <p>The result is the projected annual kWh consumption for the new system, which forms the basis for the operating cost and environmental impact calculations.</p>

            <h4>Step 3: Electrical Load Analysis</h4>
            <p>This analysis determines if your current electrical system can handle the new appliances. It's not about annual energy use (kWh), but about the instantaneous power draw (kW and Amps).</p>
            <ul>
                <li><strong>Peak Load Calculation:</strong> For each new appliance, we determine its maximum power draw in kW and convert it to Amps: <code>Amps = (kW × 1000) / Volts</code>.</li>
                <li><strong>Sum of Peaks vs. Diversified Load:</strong> Simply adding up the peak Amps of all appliances gives a worst-case, unrealistic number. It's highly unlikely you'll run your heat pump at full blast while also using your induction range, heat pump dryer, and EV charger all at their maximum power simultaneously. Therefore, we apply a "diversity factor" based on National Electrical Code (NEC) principles to get a more realistic peak load.
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>Residential:</strong> Takes 100% of the largest load (typically the heat pump) + 50% of all other new loads.</li>
                        <li><strong>Commercial:</strong> Takes 100% of the first 80 Amps of new load + 75% of the remaining load.</li>
                    </ul>
                </li>
                <li><strong>Recommendation Logic:</strong> The final recommendation compares this new diversified load, plus an assumed existing load (50% of your panel's usable capacity), against the total capacity of your panel. By code, a panel's continuous load should not exceed 80% of its rating. If the new total exceeds this, an upgrade is flagged. A sub-panel is recommended if you have enough panel capacity but not enough physical breaker spaces.</li>
            </ul>

            <h4>Step 4: Financial Analysis</h4>
            <p>This section models the complete financial picture of your project over a 15-year lifetime.</p>
            <ul>
                <li><strong>Upfront vs. Operating Costs:</strong> The analysis clearly separates the initial investment (equipment, installation, electrical work, minus rebates) from the ongoing annual costs (energy and maintenance).</li>
                <li><strong>Lifetime Savings & Payback:</strong> By projecting the annual operating costs for both systems forward using the energy price escalation rates you provide, we can calculate the cumulative savings over 15 years. The "Simple Payback Period" is the point where these cumulative savings equal your initial net investment.</li>
                <li><strong>The "High-Risk Gas Scenario":</strong> This models the potential financial risk of remaining on the gas system. As more customers electrify, the fixed costs of maintaining the gas pipe network are spread across fewer ratepayers, which could lead to significantly higher gas delivery charges for those who remain. This scenario models a higher annual price escalation to illustrate this risk.</li>
            </ul>
            
            <h4>Step 5: Environmental Impact Analysis</h4>
            <p>This analysis provides a comprehensive look at the climate impact by accounting for both carbon dioxide and the potent effects of methane.</p>
            <ul>
                <li><strong>The Problem with Methane (CH₄):</strong> Methane is the primary component of natural gas. When it leaks into the atmosphere unburned, it's a powerful greenhouse gas. This analysis includes emissions from:
                    <ol>
                        <li><strong>CO₂ from Combustion:</strong> The standard emissions from burning gas (5.3 kg CO₂/therm).</li>
                        <li><strong>Upstream Methane Leaks:</strong> Methane that leaks from wells, processing plants, and the vast network of pipes before it ever reaches you.</li>
                        <li><strong>On-site Methane Slip:</strong> Small amounts of unburned gas that can "slip" through a gas appliance during operation.</li>
                    </ol>
                </li>
                 <li><strong>GWP₂₀ vs. GWP₁₀₀ (Global Warming Potential):</strong> Methane breaks down in the atmosphere faster than CO₂, so its warming impact changes over time. This tool presents both standard metrics to give a complete picture:
                    <ul>
                        <li><strong>GWP₂₀:</strong> Over 20 years, 1 kg of methane is <strong>84 times</strong> more potent than 1 kg of CO₂. This highlights the critical near-term benefit of reducing methane to slow the rate of warming.</li>
                        <li><strong>GWP₁₀₀:</strong> Over 100 years, the same methane is <strong>28 times</strong> more potent. This is the standard used for long-term climate policy and national inventories.</li>
                    </ul>
                </li>
                <li><strong>Grid Decarbonization:</strong> The emissions from your new electric appliances are based on the current carbon intensity of the ISO New England grid. The "Grid De-CO₂ Rate" you input models how these emissions will automatically decrease year after year as more renewable energy sources like offshore wind and solar are added to the grid. This means your project's climate benefit grows over time.</li>
            </ul>
            <div class="formula-box">Total Gas CO₂e = (CO₂ from combustion) + (CH₄ from leaks & slip × GWP)</div>

            <h3>Sources & Citations</h3>
            <p>The calculations, default values, and emissions factors used in this tool are derived from the following industry-standard and region-specific sources. These are used to ensure the results are as accurate and defendable as possible for Massachusetts stakeholders.</p>
            <ul>
                <li><strong>Mass Save:</strong> Rebate amounts, program eligibility guidelines, and market data. (<a href="https://www.masssave.com/" target="_blank" rel="noopener noreferrer">masssave.com</a>)</li>
                <li><strong>ISO New England (ISO-NE):</strong> Grid emissions factors (kg CO₂e per kWh) and projections for grid decarbonization. (<a href="https://www.iso-ne.com/" target="_blank" rel="noopener noreferrer">iso-ne.com</a>)</li>
                <li><strong>U.S. Energy Information Administration (EIA):</strong> National and regional energy price trends and long-term projections. (<a href="https://www.eia.gov/" target="_blank" rel="noopener noreferrer">eia.gov</a>)</li>
                <li><strong>U.S. Environmental Protection Agency (EPA):</strong> Greenhouse gas equivalencies, emissions factors for fuel combustion, and Global Warming Potential (GWP) values. (<a href="https://www.epa.gov/energy/greenhouse-gases-equivalencies-calculator-calculations-and-references" target="_blank" rel="noopener noreferrer">epa.gov</a>)</li>
                <li><strong>ASHRAE (American Society of Heating, Refrigerating and Air-Conditioning Engineers):</strong> Standards and guidelines for HVAC equipment performance and load calculations. (<a href="https://www.ashrae.org/" target="_blank" rel="noopener noreferrer">ashrae.org</a>)</li>
                <li><strong>IPCC (Intergovernmental Panel on Climate Change):</strong> GWP values for methane from the Sixth Assessment Report (AR6). (<a href="https://www.ipcc.ch/report/ar6/wg1/" target="_blank" rel="noopener noreferrer">ipcc.ch</a>)</li>
            </ul>

            <h3>Data Sources & Disclaimer</h3>
            <p>The calculations and default values in this tool are based on data from respected public sources, including the U.S. Environmental Protection Agency (EPA), the Energy Information Administration (EIA), the Intergovernmental Panel on Climate Change (IPCC AR6), ISO New England, and program data from Mass Save. Cost estimates are based on 2024 regional market analysis.</p>
            <p><strong>IMPORTANT:</strong> This is a sophisticated planning and estimation tool, not a substitute for a professional quote. All cost, electrical, and performance figures are estimates. It is <strong>essential</strong> to obtain detailed, binding quotes from licensed and insured local HVAC and electrical professionals before making any financial commitments.</p>
        </div>

        <div id="input-tables-content" class="tab-content" role="tabpanel" aria-labelledby="tab-input-tables">
            <div class="card">
                <h3 class="card-title">Manage Default Input Values</h3>
                <p>Edit the default cost and projection data used throughout the application. Your changes will be reflected in all calculations. You can save your custom defaults to a file and load them back in a future session.</p>
                <div class="defaults-actions">
                    <button id="save-defaults-btn" class="button-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20"><path d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z" /><path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" /></svg>
                        <span>Save Defaults</span>
                    </button>
                    <div class="form-field">
                        <label for="load-defaults-input" class="button-secondary file-input-label">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20"><path d="M9.25 1.75a.75.75 0 01.75.75v8.614l2.955-3.129a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 011.09-1.03L9.25 11.114V2.5a.75.75 0 01.75-.75z" /><path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" /></svg>
                            <span>Load Defaults...</span>
                        </label>
                        <input type="file" id="load-defaults-input" accept=".json" class="sr-only">
                        <span id="loaded-defaults-filename" class="loaded-filename">No file selected.</span>
                    </div>
                </div>
            </div>

            <div class="defaults-container">
                <details open>
                    <summary>Utility Costs & Projections</summary>
                    <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr><th>Parameter</th><th>Value</th></tr>
                            </thead>
                            <tbody id="defaults-utility-tbody"></tbody>
                        </table>
                    </div>
                </details>
                <details>
                    <summary>Incentives</summary>
                     <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr><th>Incentive</th><th>Mass Save ($)</th><th>Federal IRA ($)</th></tr>
                            </thead>
                            <tbody id="defaults-incentives-tbody"></tbody>
                        </table>
                    </div>
                </details>
                <details>
                    <summary>Equipment Costs</summary>
                     <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr>
                                    <th rowspan="2">Appliance</th>
                                    <th colspan="3">Standard Efficiency</th>
                                    <th colspan="3">High Efficiency</th>
                                    <th colspan="3">Premium Efficiency</th>
                                </tr>
                                <tr>
                                    <th>Low ($)</th><th>Medium ($)</th><th>High ($)</th>
                                    <th>Low ($)</th><th>Medium ($)</th><th>High ($)</th>
                                    <th>Low ($)</th><th>Medium ($)</th><th>High ($)</th>
                                </tr>
                            </thead>
                            <tbody id="defaults-equipment-tbody"></tbody>
                        </table>
                    </div>
                </details>
                <details>
                    <summary>Installation & Labor Costs</summary>
                     <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr><th>Appliance</th><th>Low ($)</th><th>Medium ($)</th><th>High ($)</th></tr>
                            </thead>
                            <tbody id="defaults-installation-tbody"></tbody>
                        </table>
                    </div>
                </details>
                <details>
                    <summary>Heat Distribution System Costs</summary>
                     <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr><th>Item</th><th>Low ($)</th><th>Medium ($)</th><th>High ($)</th></tr>
                            </thead>
                            <tbody id="defaults-distribution-tbody"></tbody>
                        </table>
                    </div>
                </details>
                <details>
                    <summary>Decommissioning Costs</summary>
                     <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr><th>Appliance</th><th>Low ($)</th><th>Medium ($)</th><th>High ($)</th></tr>
                            </thead>
                            <tbody id="defaults-decommissioning-tbody"></tbody>
                        </table>
                    </div>
                </details>
                 <details>
                    <summary>Electrical Upgrade Costs</summary>
                     <div class="defaults-table-container">
                        <table class="defaults-table">
                            <thead>
                                <tr><th>Item</th><th>Low ($)</th><th>Medium ($)</th><th>High ($)</th></tr>
                            </thead>
                            <tbody id="defaults-electrical-tbody"></tbody>
                        </table>
                    </div>
                </details>
            </div>
        </div>


        <div id="save-load-content" class="tab-content" role="tabpanel" aria-labelledby="tab-save-load">
            <div class="card">
                <h3 class="card-title">Save Project</h3>
                <p>Save all current inputs and appliance configurations to a JSON file on your computer. You can load this file later to continue your work.</p>
                <button id="save-project-btn" class="button-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20"><path d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z" /><path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" /></svg>
                    <span>Save Project File</span>
                </button>
            </div>
            <div class="card">
                <h3 class="card-title">Load Project</h3>
                <p>Load a project from a previously saved JSON file. This will overwrite all current settings.</p>
                <div class="form-field">
                    <label for="load-project-input" class="button-secondary file-input-label">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20"><path d="M9.25 1.75a.75.75 0 01.75.75v8.614l2.955-3.129a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 011.09-1.03L9.25 11.114V2.5a.75.75 0 01.75-.75z" /><path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" /></svg>
                        <span>Choose Project File...</span>
                    </label>
                    <input type="file" id="load-project-input" accept=".json" class="sr-only">
                    <span id="loaded-filename" class="loaded-filename">No file selected.</span>
                </div>
            </div>
        </div>
    </main>

    <footer>
        Written by Tim Bickford Version 1.0
    </footer>

    <div id="modal-overlay" class="hidden"></div>
    <div id="appliance-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-header">
            <h3 id="modal-title" class="modal-title">Add Appliance</h3>
            <button id="modal-close-btn" class="modal-close-btn" aria-label="Close">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="24" height="24">
                  <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
                </svg>
            </button>
        </div>
        <div id="modal-appliance-grid" class="modal-grid">
            <!-- Appliance buttons will be inserted here -->
        </div>
    </div>

    <template id="appliance-row-template">
       <div class="appliance-entry">
            <div class="appliance-row" role="group" aria-label="Appliance Input">
                <div class="form-field include-field">
                    <label for="include-appliance-{id}">Plan</label>
                    <input type="checkbox" id="include-appliance-{id}" class="include-in-plan" name="include-in-plan" checked>
                </div>
                <div class="form-field appliance-name-field">
                    <label>Appliance</label>
                    <div class="appliance-name">Appliance Name Here</div>
                </div>
                <div class="form-field">
                    <label>BTU/hr Rating
                        <div class="tooltip-container">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                            </svg>
                            <span class="tooltip-text">The heat output rating of your gas appliance in British Thermal Units per hour. This is usually found on a label on the unit itself.</span>
                        </div>
                    </label>
                    <input type="number" class="btu-rating" name="btu-rating" placeholder="e.g., 40000" min="0" step="1000">
                </div>
                <div class="form-field">
                    <label>Efficiency (%)
                        <div class="tooltip-container">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                            </svg>
                            <span class="tooltip-text">The efficiency of your gas appliance (AFUE for furnaces, Thermal for others). This is the percentage of fuel converted to useful heat. Common values are 60-80% for older units.</span>
                        </div>
                    </label>
                    <div class="input-with-unit unit-right">
                        <input type="number" class="efficiency-rating" name="efficiency-rating" placeholder="e.g., 80" min="0" max="100" step="1">
                        <span>%</span>
                    </div>
                </div>
                <div class="heat-distribution-fields hidden">
                    <div class="form-field zones-field">
                        <label>Indoor Zones
                            <div class="tooltip-container">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                                <span class="tooltip-text">For boiler replacements, enter the number of indoor ductless "heads" or zones you plan to install. A typical home might use 3-5 to cover main living areas and bedrooms.</span>
                            </div>
                        </label>
                        <input type="number" class="zones-rating" name="zones-rating" value="3" min="1" step="1">
                    </div>
                    <div class="form-field supplemental-heaters-field">
                        <label>Supplemental Heaters
                            <div class="tooltip-container">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="tooltip-icon">
                                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                                <span class="tooltip-text">For rooms without a dedicated indoor unit (e.g., bathrooms, hallways, offices). Enter the number of small electric heaters needed to ensure whole-home comfort.</span>
                            </div>
                        </label>
                        <input type="number" class="supplemental-heaters-rating" name="supplemental-heaters-rating" value="2" min="0" step="1">
                    </div>
                </div>
                <button class="remove-btn" aria-label="Remove Appliance">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20" height="20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <div class="recommendation-details"></div>
        </div>
    </template>
    <script type="module" src="index.tsx"></script>
<script type="module" src="/index.tsx"></script>
</body>
</html>